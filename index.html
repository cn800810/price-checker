<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>价格查询与管理工具</title>

<style>
    body {
        font-family: Arial, sans-serif;
        background-color: #f4f4f4;
        margin: 0;
        padding: 20px;
        text-align: center;
    }

    h1 {
        font-size: 26px;
        margin-bottom: 30px;
    }

    input {
        padding: 12px;
        width: 80%;
        max-width: 350px;
        font-size: 18px;
        border: 1px solid #ccc;
        border-radius: 6px;
    }

    button {
        padding: 12px 28px;
        font-size: 18px;
        background-color: #1e90ff;
        border: none;
        border-radius: 6px;
        color: #fff;
        margin-left: 10px;
    }

    /* ====== 模态弹窗背景 ====== */
    .modal {
        display: none;
        position: fixed;
        z-index: 10;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0,0,0,0.55);
        justify-content: center;
        align-items: center;
    }

    /* ====== 弹窗主体 ====== */
    .modal-content {
        background: white;
        width: 90%;
        max-width: 450px;
        border-radius: 14px;
        padding: 25px;
        position: relative;
        text-align: center;
    }

    /* 关闭按钮 */
    .close {
        position: absolute;
        right: 18px;
        top: 18px;
        font-size: 26px;
        cursor: pointer;
    }

    /* 查询成功标题 */
    .modal-title {
        font-size: 28px;
        font-weight: bold;
        margin-bottom: 12px;
    }

    /* 商品代码 */
    .code-text {
        font-size: 20px;
        margin-bottom: 10px;
    }

    /* 显示价格（绿色） */
    .price-display {
        font-size: 32px;
        font-weight: bold;
        color: green;
        margin: 15px 0 25px 0;
    }

    /* 输入框宽度 55% */
    .modal-content input {
        width: 55%;
        margin: 0 auto;
        display: block;
        padding: 10px;
        font-size: 18px;
        border: 1px solid #ccc;
        border-radius: 6px;
        box-sizing: border-box;
    }

    /* 保存按钮 */
    .save-btn {
        margin-top: 25px;
        width: 80%;
        max-width: 300px;
        padding: 14px;
        font-size: 20px;
        border-radius: 10px;
        background-color: #1e90ff;
        color: #fff;
        border: none;
    }

    /* 保存成功提示（绿色） */
    .toast {
        position: fixed;
        bottom: 30px;
        left: 50%;
        transform: translateX(-50%);
        background: #28a745;
        color: white;
        padding: 14px 28px;
        border-radius: 8px;
        display: none;
        font-size: 18px;
        z-index: 20;
    }

</style>
</head>
<body>

<h1>价格查询与管理工具</h1>

<input id="codeInput" type="text" placeholder="输入商品代码…" />
<button onclick="searchPrice()">查询</button>

<!-- 弹窗 -->
<div class="modal" id="resultModal">
    <div class="modal-content">
        <span class="close" onclick="closeModal()">×</span>

        <div class="modal-title" id="modalTitle">查询结果</div>
        <div class="code-text" id="codeDisplay"></div>
        <div class="price-display" id="priceDisplay"></div>

        <input type="text" id="editPrice" placeholder="输入新价格…" />

        <button class="save-btn" onclick="savePrice()">保存</button>
    </div>
</div>

<!-- 保存成功提示 -->
<div class="toast" id="toast">保存成功</div>

<script>
    // 假数据存储，用 localStorage 作为数据库
    let priceData = JSON.parse(localStorage.getItem("priceDB") || "{}");

    function showModal() {
        document.getElementById("resultModal").style.display = "flex";
    }

    function closeModal() {
        document.getElementById("resultModal").style.display = "none";
    }

    function showToast(msg) {
        const toast = document.getElementById("toast");
        toast.innerText = msg;
        toast.style.display = "block";
        setTimeout(() => toast.style.display = "none", 1800);
    }

    // 价格查询功能
    function searchPrice() {
        const code = document.getElementById("codeInput").value.trim();
        if (!code) return;

        const price = priceData[code];

        document.getElementById("codeDisplay").innerText = "商品代码：" + code;

        if (price !== undefined) {
            // 查询成功
            document.getElementById("modalTitle").innerText = "查询成功";
            document.getElementById("modalTitle").style.color = "#000";
            document.getElementById("priceDisplay").innerText = "¥" + price;
            document.getElementById("editPrice").value = price;
        } else {
            // 没价格 → 红色提示
            document.getElementById("modalTitle").innerText = "未找到价格，需新增";
            document.getElementById("modalTitle").style.color = "red";
            document.getElementById("priceDisplay").innerText = "";
            document.getElementById("editPrice").value = "";
        }

        showModal();
    }

    // 保存价格
    function savePrice() {
        const code = document.getElementById("codeInput").value.trim();
        const newPrice = document.getElementById("editPrice").value.trim();

        if (!newPrice || isNaN(newPrice)) {
            alert("请输入正确的价格（数字）");
            return;
        }

        priceData[code] = parseFloat(newPrice).toFixed(2);
        localStorage.setItem("priceDB", JSON.stringify(priceData));

        showToast("保存成功");
        closeModal();
    }
</script>

</body>
</html>
