<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>价格查询工具</title>

<style>
    body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto;
        background: #f5f7fa;
        margin: 0;
        padding: 20px;
    }

    h1 {
        text-align: center;
        margin-bottom: 25px;
        color: #333;
    }

    .card {
        background: white;
        padding: 20px;
        margin-bottom: 20px;
        border-radius: 14px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    }

    input {
        width: 100%;
        padding: 14px;
        border-radius: 10px;
        border: 1px solid #ccc;
        font-size: 17px;
        margin-top: 8px;
        margin-bottom: 12px;
    }

    button {
        width: 100%;
        padding: 14px;
        background: #007aff;
        color: white;
        border: none;
        border-radius: 10px;
        font-size: 18px;
        cursor: pointer;
    }

    button:active {
        opacity: 0.7;
    }

    .hidden {
        display: none;
    }

    /* 弹窗 Toast */
    .toast {
        position: fixed;
        bottom: 40px;
        left: 50%;
        transform: translateX(-50%);
        padding: 14px 22px;
        color: white;
        border-radius: 10px;
        font-size: 16px;
        opacity: 0;
        transition: opacity .4s;
        z-index: 999;
    }

    .toast.show {
        opacity: 1;
    }

    .toast-green { background: #34c759; }
    .toast-red   { background: #ff3b30; }

    /* 历史列表 */
    .history-item {
        padding: 12px 12px;
        border-bottom: 1px solid #eee;
        display: flex;
        justify-content: space-between;
        font-size: 16px;
    }

</style>
</head>

<body>

<h1>价格查询工具</h1>

<div class="card">
    <label>请输入商品代码</label>
    <input type="text" id="codeInput" placeholder="例如：A123 或条形码数字" />
    <button onclick="searchCode()">查询</button>
</div>

<div id="priceCard" class="card hidden">
    <div style="margin-bottom:10px; font-size:17px;">
        未找到此商品，请输入价格：
    </div>

    <input type="number" step="0.01" id="priceInput" placeholder="请输入价格（保留两位小数）" />
    <button onclick="savePrice()">保存价格</button>
</div>

<div class="card">
    <h3 style="margin-top:0;">历史记录</h3>
    <div id="historyList"></div>
</div>

<!-- 弹窗 -->
<div id="toast" class="toast"></div>

<script>
    // 显示弹窗
    function showToast(msg, type) {
        const t = document.getElementById("toast");
        t.innerText = msg;

        t.className = "toast show " + (type === "green" ? "toast-green" : "toast-red");

        setTimeout(() => {
            t.classList.remove("show");
        }, 1800);
    }

    // 查询价格
    function searchCode() {
        const code = document.getElementById("codeInput").value.trim();
        if (!code) return;

        const data = JSON.parse(localStorage.getItem("priceDB") || "{}");

        if (data[code]) {
            // 找到价格 → 绿色弹窗
            showToast(`已找到：￥${data[code]}`, "green");
            document.getElementById("priceCard").classList.add("hidden");
        } else {
            // 未找到 → 红色弹窗
            showToast("未找到，请录入价格", "red");

            // 显示录入卡片
            document.getElementById("priceCard").classList.remove("hidden");
            document.getElementById("priceInput").value = "";
            document.getElementById("priceInput").focus();
        }
    }

    // 保存价格
    function savePrice() {
        const code = document.getElementById("codeInput").value.trim();
        let price = document.getElementById("priceInput").value.trim();

        if (!price) return;

        // 保留两位小数
        price = parseFloat(price).toFixed(2);

        const data = JSON.parse(localStorage.getItem("priceDB") || "{}");
        data[code] = price;

        localStorage.setItem("priceDB", JSON.stringify(data));

        showToast("保存成功！", "green");

        document.getElementById("priceCard").classList.add("hidden");

        loadHistory();
    }

    // 加载历史记录
    function loadHistory() {
        const list = document.getElementById("historyList");
        list.innerHTML = "";

        const data = JSON.parse(localStorage.getItem("priceDB") || "{}");
        const entries = Object.entries(data);

        entries.forEach(([code, price]) => {
            const row = document.createElement("div");
            row.className = "history-item";
            row.innerHTML = `<span>${code}</span><strong>￥${price}</strong>`;
            list.appendChild(row);
        });
    }

    loadHistory();
</script>

</body>
</html>
